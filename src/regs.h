/* SPDX-License-Identifier: GPL-2.0+ */
/*
 * Copyright 2018-2022 RnD Center "ELVEES", JSC
 */

#ifndef _REGS_H_
#define _REGS_H_

#define RISC1_BASE RISC1_UCG0
#define RISC1_UCG0	0x01900000
#define RISC1_URB	0x01910000
#define RISC1_QDMA	0x01920000
#define RISC1_VMMU	0x01924000
#define RISC1_CSR	0x01928000
#define RISC1_OnCD	0x0192c000
#define RISC1_QLIC1	0x01940000
#define SERVICE_URB	0x1f000000

#define PHYS_INTERNAL_RISC1	0x10000000

/* Service URB */
#define SURB_SDR_PPOLICY	0x0008
#define SURB_SDR_PSTATUS	0x000c
#define SURB_SDR_DBGEN		0x3034
#define SURB_UST_DBGEN		0x3040

/* URB */
#define SDR_RISC1_PPOLICY			0x70
#define SDR_RISC1_PSTATUS			0x74
#define SDR_ACC_RST_CTL				0x78
#define SDR_EXT_RST_CTL				0x90
#define SDR_BBD_RST_CTL				0x94
#define SDR_PCI_RST_CTL				0x98
#define SDR_RISC1_SOFT_NMI_SET		0x140
#define SDR_RISC1_SOFT_NMI_CLEAR	0x144
#define SDR_RISC1_SOFT_NMI_MASK		0x148
#define SDR_RISC1_SOFT_NMI_STATUS	0x14c

#define RISC1_PPOLICY_PP_OFF		0x01
#define RISC1_PPOLICY_PP_WARM_RST	0x08
#define RISC1_PPOLICY_PP_ON			0x10

/* OnCD */
#define RISC1_ONCD_IR		0x000
#define RISC1_ONCD_IDCODE	0x004
#define RISC1_ONCD_OSCR		0x008
#define RISC1_ONCD_OMBC		0x00c
#define RISC1_ONCD_OMLR0	0x010
#define RISC1_ONCD_OMLR1	0x014
#define RISC1_ONCD_OBCR		0x018
#define RISC1_ONCD_IRDEC	0x01c
#define RISC1_ONCD_OTC		0x020
#define RISC1_ONCD_PCDEC	0x024
#define RISC1_ONCD_PCEXE	0x028
#define RISC1_ONCD_PCMEM	0x02c
#define RISC1_ONCD_PC		0x030
#define RISC1_ONCD_PCR		0x230
#define RISC1_ONCD_OMAR		0x034
#define RISC1_ONCD_OMDR		0x038
#define RISC1_ONCD_MEM		0x03c
#define RISC1_ONCD_PCWB		0x040
#define RISC1_ONCD_REGF		0x044
#define RISC1_ONCD_REGFR	0x244
#define RISC1_ONCD_GO		0x048

#define RISC1_ONCD_GRFCPU	0
#define RISC1_ONCD_GRFFPU	1
#define RISC1_ONCD_GCP0		2
#define RISC1_ONCD_GHILO	3
#define RISC1_ONCD_GCP1		4
#define RISC1_ONCD_GTLB0	5
#define RISC1_ONCD_GTLB1	6
#define RISC1_ONCD_GTLBV	7

#define RISC1_ONCD_CP0_CONFIG1	0x15
#define RISC1_ONCD_CP0_CONFIG2	0x30

#define RISC1_IRD_RS_REGF	0x10
#define RISC1_IRD_READ		0x40

#define DSP_IDR		0x208
#define IDR_CLCNT_MASK	GENMASK(15, 12)
#define IDR_CLCNT_OFFT	12
#define IDR_COCNT_MASK	GENMASK(11, 8)
#define IDR_COCNT_OFFT	8
#define IDR_CLNUM_MASK	GENMASK(7, 4)
#define IDR_CLNUM_OFFT	4
#define IDR_CONUM_MASK	GENMASK(3, 0)
#define IDR_CONUM_OFFT	0
#define IDR_NCLUSTERS(x)	(((x) & IDR_CLCNT_MASK) >> IDR_CLCNT_OFFT)
#define IDR_CLUSTER(x)		(((x) & IDR_CLNUM_MASK) >> IDR_CLNUM_OFFT)
#define IDR_CLUSTERCAP(x)	(((x) & IDR_COCNT_MASK) >> IDR_COCNT_OFFT)
#define IDR_CORENUM(x)		(((x) & IDR_CONUM_MASK) >> IDR_CONUM_OFFT)

#if 0
#define DSP_TIC_CNTR	0x290

#define DSP_PC		0x300

#define DSP_IRQR	0x504
#define DSP_IMASKR	0x508
#define DSP_DQSTR	0x50C

#define DBG_INDEX	0x514

#define DSP_DBCNTR	0x608
#define DSP_DBSAR0	0x6C0
#define DSP_DBSAR1	0x6C8
#define DSP_DBSAR2	0x6D0
#define DSP_DBSAR3	0x6D8
#define DSP_DBSARNEXT	8
#endif

#define IRQR_DBG	BIT(3)
#define DQSTR_STP	BIT(31)
#define DQSTR_SC	BIT(2)
#define DQSTR_DBG	BIT(3)
#define DQSTR_ERRS	(GENMASK(5, 0) | GENMASK(19, 7))

#define CTRL_PF		BIT(15)
#define CTRL_PFN(x)	((x) << 16)
#define CTRL_DOPF	BIT(18)
#define CTRL_DOPFN(x)	((x) << 19)
#define CTRL_PFB(x)	((x) << 21)
#define CTRL_PipelineFlush	BIT(30)

#define VMMU_PAGE_MAX_LEVEL	3

#define VMMU_PTW_PBA_L		0x24000
#define VMMU_PTW_PBA_H		0x24004
#define VMMU_PTW_CFG		0x24008

// 41 bit address space
#define VMMU_PTW_CFG_41B	(0xA << 1)
#define VMMU_PTW_CFG_INV	BIT(0)
#define VMMU_PTW_CFG_A_CACHE(x)	((x) << 15)
#define VMMU_PTW_CFG_A_PROT(x)	((x) << 19)
#define VMMU_PTW_CFG_PREFETCH	BIT(22)

#define VMMU_TLBXCPT_NUM	0x2400C
#define VMMU_TLBXCPT_ADDR	0x24010
#define VMMU_TLBXCPT_TYPE	0x24014
#define VMMU_MAPSEG_START_L	0x24018
#define VMMU_MAPSEG_START_H	0x2401C
#define VMMU_MAPSEG_END_L	0x24020
#define VMMU_MAPSEG_END_H	0x24024
#define VMMU_MAPSEG_ENABLE	0x24028
#define VMMU_TLB_CTRL		0x24040
#define VMMU_TLBS		4

#define VMMU_TLB_CTRL_DUMMY	(BIT(5) | BIT(6))
#define DQSTR_TLB_ERRS		GENMASK(19, 16)

#define PHYS_INTERNAL_RISC1	0x10000000
#define PHYS_EXTERNAL_RISC1	0x03b00000
#define INTERNAL_RISC1_SIZE	0x8000

#define RISC1_PAGE_SIZE SZ_4K
#define RISC1_PAGE_SHIFT 12
#define RISC1_INPAGE_MASK GENMASK(11, 0)
#define RISC1_PTE_ENTRIES (RISC1_PAGE_SIZE / 8)

#define RISC1_PTE_V_SHIFT		0
#define RISC1_PTE_V_MASK		BIT(0)
#define RISC1_PTE_TYPE_SHIFT	1
#define RISC1_PTE_TYPE_MASK	GENMASK(4, 1)
#define RISC1_PTE_R_SHIFT		5
#define RISC1_PTE_R_MASK		BIT(5)
#define RISC1_PTE_D_SHIFT		6
#define RISC1_PTE_D_MASK		BIT(6)
#define RISC1_PTE_PADDR_SHIFT	10

#define RISC1_ARG_REGS 4
#define RISC1_FARG_REGS 4

#define RISC1_VADDR_START RISC1_PAGE_SIZE

#endif
